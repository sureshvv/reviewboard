{% extends "base.html" %}
{% load datagrid %}
{% load djblets_deco %}
{% load i18n %}
{% load reviewtags %}
{% block title %}{% trans "My Dashboard" %}{% endblock %}

{% block extrahead %}
<meta http-equiv="refresh" content="300" />
<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}rb/css/dashboard.css" />
<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}rb/css/datagrid.css" />
<script type="text/javascript" src="{{MEDIA_URL}}yui/yahoo/yahoo-min.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}yui/connection/connection-min.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}yui/dom/dom-min.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}yui/event/event-min.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}yui/dragdrop/dragdrop-min.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}yui/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}yui-ext/yui-ext.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}rb/scripts/rb/common.js"></script>
<script type="text/javascript" src="{{MEDIA_URL}}djblets/js/datagrid.js"></script>
{% endblock %}

{% block content %}
{% box "dashboard" %}
<div id="dashboard-wrapper">
 <table class="datagrid" id="dashboard-navbar">
  <colgroup>
   <col class="summary" />
   <col class="count" />
  </colgroup>
  <tbody>
{% dashboard_entry "main-item" "Starred Reviews"  "starred" %}
{% dashboard_entry "main-item" "Outgoing Reviews" "outgoing" %}
{% dashboard_entry "main-item" "Incoming Reviews" "incoming" %}
{% dashboard_entry "sub-item"  "To Me"            "to-me" %}
{% for g in user.group_set.all %}
{%  dashboard_entry "sub-item" g.name "to-group" g %}
{% endfor %}
{% ifnotequal user.get_profile.starred_groups.count 0 %}
{%  dashboard_entry "main-item" "Watched Groups" "watched-groups" %}
{%  for g in user.get_profile.starred_groups.all %}
{%   dashboard_entry "sub-item" g.name "to-group" g %}
{%  endfor %}
  </tbody>
{% endifnotequal %}
 </table>
 <div id="dashboard-main" class="clearfix">
{{datagrid.render_listview}}
 </div>
</div>
{% endbox %}
{% endblock %}
